		AREA Test, CODE
		INCLUDE LPC2368_asm.inc
		ENTRY
		EXPORT start	

start
	
	LDR R2,=FIO2_DIR ;jetzt funktioniert R2 als ein pointer 
	LDR R3,=FIO2_PIN ;Pointer auf Input Pins
	
	
	MOV R4, #0x000000FF ;alles als Output bis Bit 10 auf Input
	MOV R1, #0x00000001 ;start licht 

	
	
	LDR R5,[R2]
	ORR R5,R5,R4 ; R5 = R5 | R4 -> R5 ist der Inhalt aus FIO2_DIR 
	STR R5,[R2]
	
	MOV R2, #0x100 ; START von links
	
	LDR R9,=150600
	MOV R8,R9
	
	
	
start_from_begin
	;STR R5,[R3]
	MOV R5,R1

loop_left
	MOV R8,R9
	STR R5,[R3]
	LSL R5,#1
	
	CMP R5,#0x0000200
	
	BEQ start_from_begin
loop_one
	LDR R6,[R3]
	AND R6,R6,#0x00000400
	CMP R6,#1024
	
	;BNE loop_right
	BNE wait_me_to_right
	SUBS R8,R8,#1
	BNE loop_one
	
	
	B loop_left
	
	
	
start_from_end
	;MOV R5,R1
	;STR R5,[R3]
	MOV R5,R2  ;LEDs zuruecksetzen

loop_right
	MOV R8,R9   ;Timer zuruecksetzen
	;STR R5,[R3]
	LSR R5,R5,#1
	
	CMP R5,#0x00000000
		
	
	BEQ start_from_end

	
loop_two
	LDR R6,[R3]
	AND R6,R6,#0x00000400
	CMP R6,#1024
	
	;BNE loop_left
	BNE wait_me_to_left
	
	SUBS R8,R8,#1
	BNE loop_two
	
	STR R5,[R3]
	
	B loop_right



wait_me_to_left
	LDR R6,[R3]
	AND R6,R6,#0x00000400
	CMP R6,#1024
	BEQ loop_left
	BL wait_me_to_left
	
wait_me_to_right
	LDR R6,[R3]
	AND R6,R6,#0x00000400
	CMP R6,#1024
	BEQ loop_right
	BL wait_me_to_right
	
	
	
	END


	
